

################################################################
##### фон

# картинка
ftm_market_window_background_effect = {
	potential = {
	}
	allow = {
		always = yes
	}
	effect = {
	}
}

###  нопка настройки ###
ftm_market_settings = {
	potential = {
	}
	allow = {
		always = yes
	}
	effect = {
		if = {
			limit = {
				has_country_flag = ftm_server_country
			}
			hidden_effect = {
				country_event = { id = ftm_transfer.999 }
			}
		}
		else = {
			custom_tooltip = ftm_settings_only_for_server
		}
	}
}


################################################################
##### cлот 1

# условие отображения когда лота нет
ftm_market_slot_1_no_info = {
	potential = {
		NOT = {
			has_global_flag = ftm_market_slot_1_selected
		}
	}
	allow = {
		always = yes
	}
	effect = {
		if = {
			limit = {
				NOT = {
					has_global_flag = ftm_market_slot_1_in_progress		
				}			
			}
			hidden_effect = {
				country_event = { id = ftm_market.101 }
				set_global_flag = ftm_market_slot_1_in_progress
			}
		}
		else = {
			custom_tooltip = ftm_market_slot_in_progress_info
		}
	}
}

# условие отображение информации (для покупателей)
ftm_market_slot_1_info = {
	potential = {
		has_global_flag = ftm_market_slot_1_selected
		NOT = {
			is_same_value = event_target:ftm_marketed_fleet_slot_1_seller
		}
		has_communications = event_target:ftm_marketed_fleet_slot_1_seller
	}
	allow = {
		always = yes
	}
	effect = {
		hidden_effect = {
			country_event = { id = ftm_market.110 }
		}
	}
}

# условие отображения информации (для покупателей) если не знаком с продавцом
ftm_market_slot_1_unknown_info = {
	potential = {
		has_global_flag = ftm_market_slot_1_selected
		NOT = {
			is_same_value = event_target:ftm_marketed_fleet_slot_1_seller
		}
		NOT = {
			has_communications = event_target:ftm_marketed_fleet_slot_1_seller
		}
	}
	allow = {
		always = yes
	}
	effect = {
	}
}

# условие отображение информации (для продавца)
ftm_market_slot_1_info_seller = {
	potential = {
		has_global_flag = ftm_market_slot_1_selected
		is_same_value = event_target:ftm_marketed_fleet_slot_1_seller
	}
	allow = {
		always = yes
	}
	effect = {
		hidden_effect = {
			country_event = { id = ftm_market.110 }
		}
	}
}

# условие снятия флота с продажи (для продавца)
ftm_market_slot_1_unsell = {
	potential = {
		has_global_flag = ftm_market_slot_1_selected
		is_same_value = event_target:ftm_marketed_fleet_slot_1_seller
	}
	allow = {
		always = yes
	}
	effect = {
		hidden_effect = {
			country_event = { id = ftm_market.120 }
		}
	}
}

# условие отображения кнопки "купить"
ftm_market_slot_1_buy = {
	potential = {
		has_global_flag = ftm_market_slot_1_selected
		NOT = {
			is_same_value = event_target:ftm_marketed_fleet_slot_1_seller
		}
		has_communications = event_target:ftm_marketed_fleet_slot_1_seller
	}
	allow = {
		always = yes
	}
	effect = {
		custom_tooltip = ftm_market_slot_1_buy_info
		hidden_effect = {
			log = "[Root.GetName] want to buy fleet in slot 1."

		### energy check
			event_target:ftm_marketed_fleet_slot_1_seller = { 
				set_variable = {
					which = ftm_buyer_marketed_fleet_slot_1_energy_current_count
					value = 0
				}
			}
			set_variable = {
				which = ftm_buyer_marketed_fleet_slot_1_check_energy
				value = 0
			}
			save_event_target_as = ftm_buyer_marketed_fleet_slot_1_checker
			export_resource_stockpile_to_variable = { resource = energy variable = ftm_buyer_marketed_fleet_slot_1_check_energy }
			event_target:ftm_marketed_fleet_slot_1_seller = {
				set_variable = {
					which = ftm_buyer_marketed_fleet_slot_1_energy_current_count
					value = event_target:ftm_buyer_marketed_fleet_slot_1_checker.ftm_buyer_marketed_fleet_slot_1_check_energy
				}
			}
			log = "[Root.GetName]: energy_check complete. ENERGY: [event_target:ftm_marketed_fleet_slot_1_seller.ftm_buyer_marketed_fleet_slot_1_energy_current_count]."
			
			
			### 
			
			#4
			if = {
				limit = {
					event_target:ftm_marketed_fleet_slot_1_seller = { 
						check_variable = {
							which = ftm_buyer_marketed_fleet_slot_1_energy_current_count
							value < ftm_marketed_fleet_slot_1_cost
						}
					}
				}
				log = "Check [Root.GetName] energy: need [event_target:ftm_marketed_fleet_slot_1_seller.ftm_marketed_fleet_slot_1_cost]... FAIL. NO ENERGY."
				country_event = { id = ftm_market.105 }
			}
			if = {
				limit = {
					event_target:ftm_marketed_fleet_slot_1_seller = { 
						check_variable = {
							which = ftm_buyer_marketed_fleet_slot_1_energy_current_count
							value >= ftm_marketed_fleet_slot_1_cost
						}
					}
				}
				log = "Check [Root.GetName] energy: need [event_target:ftm_marketed_fleet_slot_1_seller.ftm_marketed_fleet_slot_1_cost]... SUCCESS. ENERGY IN."
				log = "Checking [Root.GetName] and [event_target:ftm_marketed_fleet_slot_1_seller.GetName] opinion..."
				
				# продавец - ai, отношение выше -50
				if = {
					limit = {
						AND = {
							NOT = {
								event_target:ftm_marketed_fleet_slot_1_seller = {
									OR = {
										is_rival = prev
										opinion = {
											who = prev
											value < -50
										}
										their_opinion = {
											who = prev
											value < -50
										}
									}
								}
							}
							event_target:ftm_marketed_fleet_slot_1_seller = {
								is_ai = yes
							}
						}
					}
					log = "[event_target:ftm_marketed_fleet_slot_1_seller.GetName] is AI. Opinion GOOD."
					save_global_event_target_as = ftm_market_slot_1_buyer
					
					# передача флота и денег
					event_target:ftm_marketed_fleet_slot_1 = { 
						set_owner = event_target:ftm_market_slot_1_buyer
						set_event_locked = no
					}
					event_target:ftm_market_slot_1_buyer = { 
						country_event = { id = ftm_market.111 }
					
					
						# снятие ресурсов при покупке			
				
						event_target:ftm_marketed_fleet_slot_1_seller = { 
							set_variable = {
								which = ftm_marketed_fleet_slot_1_lot_cost
								value = ftm_marketed_fleet_slot_1_cost
							}
						}
						log = "[Root.GetName]: [event_target:ftm_marketed_fleet_slot_1_seller.ftm_marketed_fleet_slot_1_lot_cost] energy is SLOT-1 cost"	
						while = {
							count = 99
							if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_1_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_1_lot_cost
											value >= 10000
										}
									}
								}
								add_resource = { energy = -10000 }
								event_target:ftm_marketed_fleet_slot_1_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_1_lot_cost
										value = -10000
									}
								}
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_1_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_1_lot_cost
											value >= 1000
										}
									}
								}
								add_resource = { energy = -1000 }
								event_target:ftm_marketed_fleet_slot_1_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_1_lot_cost
										value = -1000
									}		
								}
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_1_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_1_lot_cost
											value >= 100
										}
									}
								}
								add_resource = { energy = -100 }
								event_target:ftm_marketed_fleet_slot_1_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_1_lot_cost
										value = -100
									}
								}					
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_1_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_1_lot_cost
											value >= 10
										}
									}
								}
								add_resource = { energy = -10 }
								event_target:ftm_marketed_fleet_slot_1_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_1_lot_cost
										value = -10
									}
								}
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_1_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_1_lot_cost
											value >= 1
										}
									}
								}
								add_resource = { energy = -1 }
								event_target:ftm_marketed_fleet_slot_1_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_1_lot_cost
										value = -1
									}					
								}
							}
							else = {
								#nothing
							}
						}	
					}
					event_target:ftm_marketed_fleet_slot_1_seller = { 
						country_event = { id = ftm_market.112 }
					}
					remove_global_flag = ftm_market_slot_1_selected	
				}
				
				# продавец - ai, отношение плохое
				if = {
					limit = {
						AND = {
							event_target:ftm_marketed_fleet_slot_1_seller = {
								OR = {
									is_rival = prev
									opinion = {
										who = prev
										value < -50
									}
									their_opinion = {
										who = prev
										value < -50
									}
								}
							}
							event_target:ftm_marketed_fleet_slot_1_seller = {
								is_ai = yes
							}
						}
					}
					log = "[event_target:ftm_marketed_fleet_slot_1_seller.GetName] is AI. Opinion BAD."
					country_event = { id = ftm_market.114 }
				}
				
				# продавец - игрок
				if = {
					limit = {
						event_target:ftm_marketed_fleet_slot_1_seller = {
							is_ai = no
						}
					}
					log = "[event_target:ftm_marketed_fleet_slot_1_seller.GetName] is PLAYER. Sending request..."
					save_event_target_as = ftm_market_slot_1_requester
					
				
					# снятие ресурсов 	
			
					event_target:ftm_marketed_fleet_slot_1_seller = { 
						set_variable = {
							which = ftm_marketed_fleet_slot_1_lot_cost
							value = ftm_marketed_fleet_slot_1_cost
						}
					}	
					while = {
						count = 99
						if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_1_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_1_lot_cost
										value >= 10000
									}
								}
							}
							add_resource = { energy = -10000 }
							event_target:ftm_marketed_fleet_slot_1_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_1_lot_cost
									value = -10000
								}
							}
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_1_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_1_lot_cost
										value >= 1000
									}
								}
							}
							add_resource = { energy = -1000 }
							event_target:ftm_marketed_fleet_slot_1_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_1_lot_cost
									value = -1000
								}		
							}
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_1_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_1_lot_cost
										value >= 100
									}
								}
							}
							add_resource = { energy = -100 }
							event_target:ftm_marketed_fleet_slot_1_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_1_lot_cost
									value = -100
								}
							}					
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_1_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_1_lot_cost
										value >= 10
									}
								}
							}
							add_resource = { energy = -10 }
							event_target:ftm_marketed_fleet_slot_1_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_1_lot_cost
									value = -10
								}
							}
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_1_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_1_lot_cost
										value >= 1
									}
								}
							}
							add_resource = { energy = -1 }
							event_target:ftm_marketed_fleet_slot_1_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_1_lot_cost
									value = -1
								}					
							}
						}
						else = {
							#nothing
						}
					}
					
					country_event = { id = ftm_market.115 }
					event_target:ftm_marketed_fleet_slot_1_seller = {
						country_event = { id = ftm_market.116 }
					}
				}
			}
		}
	}
}


################################################################
##### cлот 2

# условие отображения когда лота нет
ftm_market_slot_2_no_info = {
	potential = {
		NOT = {
			has_global_flag = ftm_market_slot_2_selected
		}
	}
	allow = {
		always = yes
	}
	effect = {
		if = {
			limit = {
				NOT = {
					has_global_flag = ftm_market_slot_2_in_progress		
				}			
			}
			hidden_effect = {
				country_event = { id = ftm_market.201 }
				set_global_flag = ftm_market_slot_2_in_progress
			}
		}
		else = {
			custom_tooltip = ftm_market_slot_in_progress_info
		}
	}
}

# условие отображение информации (для покупателей)
ftm_market_slot_2_info = {
	potential = {
		has_global_flag = ftm_market_slot_2_selected
		NOT = {
			is_same_value = event_target:ftm_marketed_fleet_slot_2_seller
		}
		has_communications = event_target:ftm_marketed_fleet_slot_2_seller
	}
	allow = {
		always = yes
	}
	effect = {
		hidden_effect = {
			country_event = { id = ftm_market.210 }
		}
	}
}

# условие отображения информации (для покупателей) если не знаком с продавцом
ftm_market_slot_2_unknown_info = {
	potential = {
		has_global_flag = ftm_market_slot_2_selected
		NOT = {
			is_same_value = event_target:ftm_marketed_fleet_slot_2_seller
		}
		NOT = {
			has_communications = event_target:ftm_marketed_fleet_slot_2_seller
		}
	}
	allow = {
		always = yes
	}
	effect = {
	}
}

# условие отображение информации (для продавца)
ftm_market_slot_2_info_seller = {
	potential = {
		has_global_flag = ftm_market_slot_2_selected
		is_same_value = event_target:ftm_marketed_fleet_slot_2_seller
	}
	allow = {
		always = yes
	}
	effect = {
		hidden_effect = {
			country_event = { id = ftm_market.210 }
		}
	}
}

# условие снятия флота с продажи (для продавца)
ftm_market_slot_2_unsell = {
	potential = {
		has_global_flag = ftm_market_slot_2_selected
		is_same_value = event_target:ftm_marketed_fleet_slot_2_seller
	}
	allow = {
		always = yes
	}
	effect = {
		hidden_effect = {
			country_event = { id = ftm_market.220 }
		}
	}
}

# условие отображения кнопки "купить"
ftm_market_slot_2_buy = {
	potential = {
		has_global_flag = ftm_market_slot_2_selected
		NOT = {
			is_same_value = event_target:ftm_marketed_fleet_slot_2_seller
		}
		has_communications = event_target:ftm_marketed_fleet_slot_2_seller
	}
	allow = {
		always = yes
	}
	effect = {
		custom_tooltip = ftm_market_slot_2_buy_info
		hidden_effect = {
			log = "[Root.GetName] want to buy fleet in slot 2."

		### energy check
			event_target:ftm_marketed_fleet_slot_2_seller = { 
				set_variable = {
					which = ftm_buyer_marketed_fleet_slot_2_energy_current_count
					value = 0
				}
			}
			set_variable = {
				which = ftm_buyer_marketed_fleet_slot_2_check_energy
				value = 0
			}
			save_event_target_as = ftm_buyer_marketed_fleet_slot_2_checker
			export_resource_stockpile_to_variable = { resource = energy variable = ftm_buyer_marketed_fleet_slot_2_check_energy }
			event_target:ftm_marketed_fleet_slot_2_seller = {
				set_variable = {
					which = ftm_buyer_marketed_fleet_slot_2_energy_current_count
					value = event_target:ftm_buyer_marketed_fleet_slot_2_checker.ftm_buyer_marketed_fleet_slot_2_check_energy
				}
			}
			log = "[Root.GetName]: energy_check complete. ENERGY: [event_target:ftm_marketed_fleet_slot_2_seller.ftm_buyer_marketed_fleet_slot_2_energy_current_count]."
			
			
			### 
			
			#4
			if = {
				limit = {
					event_target:ftm_marketed_fleet_slot_2_seller = { 
						check_variable = {
							which = ftm_buyer_marketed_fleet_slot_2_energy_current_count
							value < ftm_marketed_fleet_slot_2_cost
						}
					}
				}
				log = "Check [Root.GetName] energy: need [event_target:ftm_marketed_fleet_slot_2_seller.ftm_marketed_fleet_slot_2_cost]... FAIL. NO ENERGY."
				country_event = { id = ftm_market.205 }
			}
			if = {
				limit = {
					event_target:ftm_marketed_fleet_slot_2_seller = { 
						check_variable = {
							which = ftm_buyer_marketed_fleet_slot_2_energy_current_count
							value >= ftm_marketed_fleet_slot_2_cost
						}
					}
				}
				log = "Check [Root.GetName] energy: need [event_target:ftm_marketed_fleet_slot_2_seller.ftm_marketed_fleet_slot_2_cost]... SUCCESS. ENERGY IN."
				log = "Checking [Root.GetName] and [event_target:ftm_marketed_fleet_slot_2_seller.GetName] opinion..."
				
				# продавец - ai, отношение выше -50
				if = {
					limit = {
						AND = {
							NOT = {
								event_target:ftm_marketed_fleet_slot_2_seller = {
									OR = {
										is_rival = prev
										opinion = {
											who = prev
											value < -50
										}
										their_opinion = {
											who = prev
											value < -50
										}
									}
								}
							}
							event_target:ftm_marketed_fleet_slot_2_seller = {
								is_ai = yes
							}
						}
					}
					log = "[event_target:ftm_marketed_fleet_slot_2_seller.GetName] is AI. Opinion GOOD."
					save_global_event_target_as = ftm_market_slot_2_buyer
					
					# передача флота и денег
					event_target:ftm_marketed_fleet_slot_2 = { 
						set_owner = event_target:ftm_market_slot_2_buyer
						set_event_locked = no
					}
					event_target:ftm_market_slot_2_buyer = { 
						country_event = { id = ftm_market.211 }
					
					
						# снятие ресурсов при покупке			
				
						event_target:ftm_marketed_fleet_slot_2_seller = { 
							set_variable = {
								which = ftm_marketed_fleet_slot_2_lot_cost
								value = ftm_marketed_fleet_slot_2_cost
							}
						}
						log = "[Root.GetName]: [event_target:ftm_marketed_fleet_slot_2_seller.ftm_marketed_fleet_slot_2_lot_cost] energy is SLOT-1 cost"	
						while = {
							count = 99
							if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_2_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_2_lot_cost
											value >= 10000
										}
									}
								}
								add_resource = { energy = -10000 }
								event_target:ftm_marketed_fleet_slot_2_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_2_lot_cost
										value = -10000
									}
								}
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_2_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_2_lot_cost
											value >= 1000
										}
									}
								}
								add_resource = { energy = -1000 }
								event_target:ftm_marketed_fleet_slot_2_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_2_lot_cost
										value = -1000
									}		
								}
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_2_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_2_lot_cost
											value >= 100
										}
									}
								}
								add_resource = { energy = -100 }
								event_target:ftm_marketed_fleet_slot_2_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_2_lot_cost
										value = -100
									}
								}					
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_2_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_2_lot_cost
											value >= 10
										}
									}
								}
								add_resource = { energy = -10 }
								event_target:ftm_marketed_fleet_slot_2_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_2_lot_cost
										value = -10
									}
								}
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_2_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_2_lot_cost
											value >= 1
										}
									}
								}
								add_resource = { energy = -1 }
								event_target:ftm_marketed_fleet_slot_2_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_2_lot_cost
										value = -1
									}					
								}
							}
							else = {
								#nothing
							}
						}	
					}
					event_target:ftm_marketed_fleet_slot_2_seller = { 
						country_event = { id = ftm_market.212 }
					}
					remove_global_flag = ftm_market_slot_2_selected	
				}
				
				# продавец - ai, отношение плохое
				if = {
					limit = {
						AND = {
							event_target:ftm_marketed_fleet_slot_2_seller = {
								OR = {
									is_rival = prev
									opinion = {
										who = prev
										value < -50
									}
									their_opinion = {
										who = prev
										value < -50
									}
								}
							}
							event_target:ftm_marketed_fleet_slot_2_seller = {
								is_ai = yes
							}
						}
					}
					log = "[event_target:ftm_marketed_fleet_slot_2_seller.GetName] is AI. Opinion BAD."
					country_event = { id = ftm_market.214 }
				}
				
				# продавец - игрок
				if = {
					limit = {
						event_target:ftm_marketed_fleet_slot_2_seller = {
							is_ai = no
						}
					}
					log = "[event_target:ftm_marketed_fleet_slot_2_seller.GetName] is PLAYER. Sending request..."
					save_event_target_as = ftm_market_slot_2_requester
					
				
					# снятие ресурсов 	
			
					event_target:ftm_marketed_fleet_slot_2_seller = { 
						set_variable = {
							which = ftm_marketed_fleet_slot_2_lot_cost
							value = ftm_marketed_fleet_slot_2_cost
						}
					}	
					while = {
						count = 99
						if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_2_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_2_lot_cost
										value >= 10000
									}
								}
							}
							add_resource = { energy = -10000 }
							event_target:ftm_marketed_fleet_slot_2_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_2_lot_cost
									value = -10000
								}
							}
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_2_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_2_lot_cost
										value >= 1000
									}
								}
							}
							add_resource = { energy = -1000 }
							event_target:ftm_marketed_fleet_slot_2_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_2_lot_cost
									value = -1000
								}		
							}
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_2_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_2_lot_cost
										value >= 100
									}
								}
							}
							add_resource = { energy = -100 }
							event_target:ftm_marketed_fleet_slot_2_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_2_lot_cost
									value = -100
								}
							}					
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_2_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_2_lot_cost
										value >= 10
									}
								}
							}
							add_resource = { energy = -10 }
							event_target:ftm_marketed_fleet_slot_2_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_2_lot_cost
									value = -10
								}
							}
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_2_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_2_lot_cost
										value >= 1
									}
								}
							}
							add_resource = { energy = -1 }
							event_target:ftm_marketed_fleet_slot_2_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_2_lot_cost
									value = -1
								}					
							}
						}
						else = {
							#nothing
						}
					}
					
					country_event = { id = ftm_market.215 }
					event_target:ftm_marketed_fleet_slot_2_seller = {
						country_event = { id = ftm_market.216 }
					}
				}
			}
		}
	}
}


################################################################
##### cлот 3

# условие отображения когда лота нет
ftm_market_slot_3_no_info = {
	potential = {
		NOT = {
			has_global_flag = ftm_market_slot_3_selected
		}
	}
	allow = {
		always = yes
	}
	effect = {
		if = {
			limit = {
				NOT = {
					has_global_flag = ftm_market_slot_3_in_progress		
				}			
			}
			hidden_effect = {
				country_event = { id = ftm_market.301 }
				set_global_flag = ftm_market_slot_3_in_progress
			}
		}
		else = {
			custom_tooltip = ftm_market_slot_in_progress_info
		}
	}
}

# условие отображение информации (для покупателей)
ftm_market_slot_3_info = {
	potential = {
		has_global_flag = ftm_market_slot_3_selected
		NOT = {
			is_same_value = event_target:ftm_marketed_fleet_slot_3_seller
		}
		has_communications = event_target:ftm_marketed_fleet_slot_3_seller
	}
	allow = {
		always = yes
	}
	effect = {
		hidden_effect = {
			country_event = { id = ftm_market.310 }
		}
	}
}

# условие отображения информации (для покупателей) если не знаком с продавцом
ftm_market_slot_3_unknown_info = {
	potential = {
		has_global_flag = ftm_market_slot_3_selected
		NOT = {
			is_same_value = event_target:ftm_marketed_fleet_slot_3_seller
		}
		NOT = {
			has_communications = event_target:ftm_marketed_fleet_slot_3_seller
		}
	}
	allow = {
		always = yes
	}
	effect = {
	}
}

# условие отображение информации (для продавца)
ftm_market_slot_3_info_seller = {
	potential = {
		has_global_flag = ftm_market_slot_3_selected
		is_same_value = event_target:ftm_marketed_fleet_slot_3_seller
	}
	allow = {
		always = yes
	}
	effect = {
		hidden_effect = {
			country_event = { id = ftm_market.310 }
		}
	}
}

# условие снятия флота с продажи (для продавца)
ftm_market_slot_3_unsell = {
	potential = {
		has_global_flag = ftm_market_slot_3_selected
		is_same_value = event_target:ftm_marketed_fleet_slot_3_seller
	}
	allow = {
		always = yes
	}
	effect = {
		hidden_effect = {
			country_event = { id = ftm_market.320 }
		}
	}
}

# условие отображения кнопки "купить"
ftm_market_slot_3_buy = {
	potential = {
		has_global_flag = ftm_market_slot_3_selected
		NOT = {
			is_same_value = event_target:ftm_marketed_fleet_slot_3_seller
		}
		has_communications = event_target:ftm_marketed_fleet_slot_3_seller
	}
	allow = {
		always = yes
	}
	effect = {
		custom_tooltip = ftm_market_slot_3_buy_info
		hidden_effect = {
			log = "[Root.GetName] want to buy fleet in slot 3."

		### energy check
			event_target:ftm_marketed_fleet_slot_3_seller = { 
				set_variable = {
					which = ftm_buyer_marketed_fleet_slot_3_energy_current_count
					value = 0
				}
			}
			set_variable = {
				which = ftm_buyer_marketed_fleet_slot_3_check_energy
				value = 0
			}
			save_event_target_as = ftm_buyer_marketed_fleet_slot_3_checker
			export_resource_stockpile_to_variable = { resource = energy variable = ftm_buyer_marketed_fleet_slot_3_check_energy }
			event_target:ftm_marketed_fleet_slot_3_seller = {
				set_variable = {
					which = ftm_buyer_marketed_fleet_slot_3_energy_current_count
					value = event_target:ftm_buyer_marketed_fleet_slot_3_checker.ftm_buyer_marketed_fleet_slot_3_check_energy
				}
			}
			log = "[Root.GetName]: energy_check complete. ENERGY: [event_target:ftm_marketed_fleet_slot_3_seller.ftm_buyer_marketed_fleet_slot_3_energy_current_count]."
			
			
			### 
			
			#4
			if = {
				limit = {
					event_target:ftm_marketed_fleet_slot_3_seller = { 
						check_variable = {
							which = ftm_buyer_marketed_fleet_slot_3_energy_current_count
							value < ftm_marketed_fleet_slot_3_cost
						}
					}
				}
				log = "Check [Root.GetName] energy: need [event_target:ftm_marketed_fleet_slot_3_seller.ftm_marketed_fleet_slot_3_cost]... FAIL. NO ENERGY."
				country_event = { id = ftm_market.305 }
			}
			if = {
				limit = {
					event_target:ftm_marketed_fleet_slot_3_seller = { 
						check_variable = {
							which = ftm_buyer_marketed_fleet_slot_3_energy_current_count
							value >= ftm_marketed_fleet_slot_3_cost
						}
					}
				}
				log = "Check [Root.GetName] energy: need [event_target:ftm_marketed_fleet_slot_3_seller.ftm_marketed_fleet_slot_3_cost]... SUCCESS. ENERGY IN."
				log = "Checking [Root.GetName] and [event_target:ftm_marketed_fleet_slot_3_seller.GetName] opinion..."
				
				# продавец - ai, отношение выше -50
				if = {
					limit = {
						AND = {
							NOT = {
								event_target:ftm_marketed_fleet_slot_3_seller = {
									OR = {
										is_rival = prev
										opinion = {
											who = prev
											value < -50
										}
										their_opinion = {
											who = prev
											value < -50
										}
									}
								}
							}
							event_target:ftm_marketed_fleet_slot_3_seller = {
								is_ai = yes
							}
						}
					}
					log = "[event_target:ftm_marketed_fleet_slot_3_seller.GetName] is AI. Opinion GOOD."
					save_global_event_target_as = ftm_market_slot_3_buyer
					
					# передача флота и денег
					event_target:ftm_marketed_fleet_slot_3 = { 
						set_owner = event_target:ftm_market_slot_3_buyer
						set_event_locked = no
					}
					event_target:ftm_market_slot_3_buyer = { 
						country_event = { id = ftm_market.311 }
					
					
						# снятие ресурсов при покупке			
				
						event_target:ftm_marketed_fleet_slot_3_seller = { 
							set_variable = {
								which = ftm_marketed_fleet_slot_3_lot_cost
								value = ftm_marketed_fleet_slot_3_cost
							}
						}
						log = "[Root.GetName]: [event_target:ftm_marketed_fleet_slot_3_seller.ftm_marketed_fleet_slot_3_lot_cost] energy is SLOT-1 cost"	
						while = {
							count = 99
							if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_3_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_3_lot_cost
											value >= 10000
										}
									}
								}
								add_resource = { energy = -10000 }
								event_target:ftm_marketed_fleet_slot_3_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_3_lot_cost
										value = -10000
									}
								}
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_3_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_3_lot_cost
											value >= 1000
										}
									}
								}
								add_resource = { energy = -1000 }
								event_target:ftm_marketed_fleet_slot_3_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_3_lot_cost
										value = -1000
									}		
								}
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_3_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_3_lot_cost
											value >= 100
										}
									}
								}
								add_resource = { energy = -100 }
								event_target:ftm_marketed_fleet_slot_3_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_3_lot_cost
										value = -100
									}
								}					
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_3_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_3_lot_cost
											value >= 10
										}
									}
								}
								add_resource = { energy = -10 }
								event_target:ftm_marketed_fleet_slot_3_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_3_lot_cost
										value = -10
									}
								}
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_3_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_3_lot_cost
											value >= 1
										}
									}
								}
								add_resource = { energy = -1 }
								event_target:ftm_marketed_fleet_slot_3_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_3_lot_cost
										value = -1
									}					
								}
							}
							else = {
								#nothing
							}
						}	
					}
					event_target:ftm_marketed_fleet_slot_3_seller = { 
						country_event = { id = ftm_market.312 }
					}
					remove_global_flag = ftm_market_slot_3_selected	
				}
				
				# продавец - ai, отношение плохое
				if = {
					limit = {
						AND = {
							event_target:ftm_marketed_fleet_slot_3_seller = {
								OR = {
									is_rival = prev
									opinion = {
										who = prev
										value < -50
									}
									their_opinion = {
										who = prev
										value < -50
									}
								}
							}
							event_target:ftm_marketed_fleet_slot_3_seller = {
								is_ai = yes
							}
						}
					}
					log = "[event_target:ftm_marketed_fleet_slot_3_seller.GetName] is AI. Opinion BAD."
					country_event = { id = ftm_market.314 }
				}
				
				# продавец - игрок
				if = {
					limit = {
						event_target:ftm_marketed_fleet_slot_3_seller = {
							is_ai = no
						}
					}
					log = "[event_target:ftm_marketed_fleet_slot_3_seller.GetName] is PLAYER. Sending request..."
					save_event_target_as = ftm_market_slot_3_requester
					
				
					# снятие ресурсов 	
			
					event_target:ftm_marketed_fleet_slot_3_seller = { 
						set_variable = {
							which = ftm_marketed_fleet_slot_3_lot_cost
							value = ftm_marketed_fleet_slot_3_cost
						}
					}	
					while = {
						count = 99
						if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_3_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_3_lot_cost
										value >= 10000
									}
								}
							}
							add_resource = { energy = -10000 }
							event_target:ftm_marketed_fleet_slot_3_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_3_lot_cost
									value = -10000
								}
							}
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_3_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_3_lot_cost
										value >= 1000
									}
								}
							}
							add_resource = { energy = -1000 }
							event_target:ftm_marketed_fleet_slot_3_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_3_lot_cost
									value = -1000
								}		
							}
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_3_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_3_lot_cost
										value >= 100
									}
								}
							}
							add_resource = { energy = -100 }
							event_target:ftm_marketed_fleet_slot_3_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_3_lot_cost
									value = -100
								}
							}					
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_3_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_3_lot_cost
										value >= 10
									}
								}
							}
							add_resource = { energy = -10 }
							event_target:ftm_marketed_fleet_slot_3_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_3_lot_cost
									value = -10
								}
							}
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_3_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_3_lot_cost
										value >= 1
									}
								}
							}
							add_resource = { energy = -1 }
							event_target:ftm_marketed_fleet_slot_3_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_3_lot_cost
									value = -1
								}					
							}
						}
						else = {
							#nothing
						}
					}
					
					country_event = { id = ftm_market.315 }
					event_target:ftm_marketed_fleet_slot_3_seller = {
						country_event = { id = ftm_market.316 }
					}
				}
			}
		}
	}
}


################################################################
##### cлот 4

# условие отображения когда лота нет
ftm_market_slot_4_no_info = {
	potential = {
		NOT = {
			has_global_flag = ftm_market_slot_4_selected
		}
	}
	allow = {
		always = yes
	}
	effect = {
		if = {
			limit = {
				NOT = {
					has_global_flag = ftm_market_slot_4_in_progress		
				}			
			}
			hidden_effect = {
				country_event = { id = ftm_market.401 }
				set_global_flag = ftm_market_slot_4_in_progress
			}
		}
		else = {
			custom_tooltip = ftm_market_slot_in_progress_info
		}
	}
}

# условие отображение информации (для покупателей)
ftm_market_slot_4_info = {
	potential = {
		has_global_flag = ftm_market_slot_4_selected
		NOT = {
			is_same_value = event_target:ftm_marketed_fleet_slot_4_seller
		}
		has_communications = event_target:ftm_marketed_fleet_slot_4_seller
	}
	allow = {
		always = yes
	}
	effect = {
		hidden_effect = {
			country_event = { id = ftm_market.410 }
		}
	}
}

# условие отображения информации (для покупателей) если не знаком с продавцом
ftm_market_slot_4_unknown_info = {
	potential = {
		has_global_flag = ftm_market_slot_4_selected
		NOT = {
			is_same_value = event_target:ftm_marketed_fleet_slot_4_seller
		}
		NOT = {
			has_communications = event_target:ftm_marketed_fleet_slot_4_seller
		}
	}
	allow = {
		always = yes
	}
	effect = {
	}
}

# условие отображение информации (для продавца)
ftm_market_slot_4_info_seller = {
	potential = {
		has_global_flag = ftm_market_slot_4_selected
		is_same_value = event_target:ftm_marketed_fleet_slot_4_seller
	}
	allow = {
		always = yes
	}
	effect = {
		hidden_effect = {
			country_event = { id = ftm_market.410 }
		}
	}
}

# условие снятия флота с продажи (для продавца)
ftm_market_slot_4_unsell = {
	potential = {
		has_global_flag = ftm_market_slot_4_selected
		is_same_value = event_target:ftm_marketed_fleet_slot_4_seller
	}
	allow = {
		always = yes
	}
	effect = {
		hidden_effect = {
			country_event = { id = ftm_market.420 }
		}
	}
}

# условие отображения кнопки "купить"
ftm_market_slot_4_buy = {
	potential = {
		has_global_flag = ftm_market_slot_4_selected
		NOT = {
			is_same_value = event_target:ftm_marketed_fleet_slot_4_seller
		}
		has_communications = event_target:ftm_marketed_fleet_slot_4_seller
	}
	allow = {
		always = yes
	}
	effect = {
		custom_tooltip = ftm_market_slot_4_buy_info
		hidden_effect = {
			log = "[Root.GetName] want to buy fleet in slot 4."

		### energy check
			event_target:ftm_marketed_fleet_slot_4_seller = { 
				set_variable = {
					which = ftm_buyer_marketed_fleet_slot_4_energy_current_count
					value = 0
				}
			}
			set_variable = {
				which = ftm_buyer_marketed_fleet_slot_4_check_energy
				value = 0
			}
			save_event_target_as = ftm_buyer_marketed_fleet_slot_4_checker
			export_resource_stockpile_to_variable = { resource = energy variable = ftm_buyer_marketed_fleet_slot_4_check_energy }
			event_target:ftm_marketed_fleet_slot_4_seller = {
				set_variable = {
					which = ftm_buyer_marketed_fleet_slot_4_energy_current_count
					value = event_target:ftm_buyer_marketed_fleet_slot_4_checker.ftm_buyer_marketed_fleet_slot_4_check_energy
				}
			}
			log = "[Root.GetName]: energy_check complete. ENERGY: [event_target:ftm_marketed_fleet_slot_4_seller.ftm_buyer_marketed_fleet_slot_4_energy_current_count]."
			
			
			### 
			
			#4
			if = {
				limit = {
					event_target:ftm_marketed_fleet_slot_4_seller = { 
						check_variable = {
							which = ftm_buyer_marketed_fleet_slot_4_energy_current_count
							value < ftm_marketed_fleet_slot_4_cost
						}
					}
				}
				log = "Check [Root.GetName] energy: need [event_target:ftm_marketed_fleet_slot_4_seller.ftm_marketed_fleet_slot_4_cost]... FAIL. NO ENERGY."
				country_event = { id = ftm_market.405 }
			}
			if = {
				limit = {
					event_target:ftm_marketed_fleet_slot_4_seller = { 
						check_variable = {
							which = ftm_buyer_marketed_fleet_slot_4_energy_current_count
							value >= ftm_marketed_fleet_slot_4_cost
						}
					}
				}
				log = "Check [Root.GetName] energy: need [event_target:ftm_marketed_fleet_slot_4_seller.ftm_marketed_fleet_slot_4_cost]... SUCCESS. ENERGY IN."
				log = "Checking [Root.GetName] and [event_target:ftm_marketed_fleet_slot_4_seller.GetName] opinion..."
				
				# продавец - ai, отношение выше -50
				if = {
					limit = {
						AND = {
							NOT = {
								event_target:ftm_marketed_fleet_slot_4_seller = {
									OR = {
										is_rival = prev
										opinion = {
											who = prev
											value < -50
										}
										their_opinion = {
											who = prev
											value < -50
										}
									}
								}
							}
							event_target:ftm_marketed_fleet_slot_4_seller = {
								is_ai = yes
							}
						}
					}
					log = "[event_target:ftm_marketed_fleet_slot_4_seller.GetName] is AI. Opinion GOOD."
					save_global_event_target_as = ftm_market_slot_4_buyer
					
					# передача флота и денег
					event_target:ftm_marketed_fleet_slot_4 = { 
						set_owner = event_target:ftm_market_slot_4_buyer
						set_event_locked = no
					}
					event_target:ftm_market_slot_4_buyer = { 
						country_event = { id = ftm_market.411 }
					
					
						# снятие ресурсов при покупке			
				
						event_target:ftm_marketed_fleet_slot_4_seller = { 
							set_variable = {
								which = ftm_marketed_fleet_slot_4_lot_cost
								value = ftm_marketed_fleet_slot_4_cost
							}
						}
						log = "[Root.GetName]: [event_target:ftm_marketed_fleet_slot_4_seller.ftm_marketed_fleet_slot_4_lot_cost] energy is SLOT-1 cost"	
						while = {
							count = 99
							if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_4_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_4_lot_cost
											value >= 10000
										}
									}
								}
								add_resource = { energy = -10000 }
								event_target:ftm_marketed_fleet_slot_4_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_4_lot_cost
										value = -10000
									}
								}
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_4_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_4_lot_cost
											value >= 1000
										}
									}
								}
								add_resource = { energy = -1000 }
								event_target:ftm_marketed_fleet_slot_4_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_4_lot_cost
										value = -1000
									}		
								}
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_4_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_4_lot_cost
											value >= 100
										}
									}
								}
								add_resource = { energy = -100 }
								event_target:ftm_marketed_fleet_slot_4_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_4_lot_cost
										value = -100
									}
								}					
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_4_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_4_lot_cost
											value >= 10
										}
									}
								}
								add_resource = { energy = -10 }
								event_target:ftm_marketed_fleet_slot_4_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_4_lot_cost
										value = -10
									}
								}
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_4_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_4_lot_cost
											value >= 1
										}
									}
								}
								add_resource = { energy = -1 }
								event_target:ftm_marketed_fleet_slot_4_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_4_lot_cost
										value = -1
									}					
								}
							}
							else = {
								#nothing
							}
						}	
					}
					event_target:ftm_marketed_fleet_slot_4_seller = { 
						country_event = { id = ftm_market.412 }
					}
					remove_global_flag = ftm_market_slot_4_selected	
				}
				
				# продавец - ai, отношение плохое
				if = {
					limit = {
						AND = {
							event_target:ftm_marketed_fleet_slot_4_seller = {
								OR = {
									is_rival = prev
									opinion = {
										who = prev
										value < -50
									}
									their_opinion = {
										who = prev
										value < -50
									}
								}
							}
							event_target:ftm_marketed_fleet_slot_4_seller = {
								is_ai = yes
							}
						}
					}
					log = "[event_target:ftm_marketed_fleet_slot_4_seller.GetName] is AI. Opinion BAD."
					country_event = { id = ftm_market.414 }
				}
				
				# продавец - игрок
				if = {
					limit = {
						event_target:ftm_marketed_fleet_slot_4_seller = {
							is_ai = no
						}
					}
					log = "[event_target:ftm_marketed_fleet_slot_4_seller.GetName] is PLAYER. Sending request..."
					save_event_target_as = ftm_market_slot_4_requester
					
				
					# снятие ресурсов 	
			
					event_target:ftm_marketed_fleet_slot_4_seller = { 
						set_variable = {
							which = ftm_marketed_fleet_slot_4_lot_cost
							value = ftm_marketed_fleet_slot_4_cost
						}
					}	
					while = {
						count = 99
						if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_4_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_4_lot_cost
										value >= 10000
									}
								}
							}
							add_resource = { energy = -10000 }
							event_target:ftm_marketed_fleet_slot_4_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_4_lot_cost
									value = -10000
								}
							}
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_4_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_4_lot_cost
										value >= 1000
									}
								}
							}
							add_resource = { energy = -1000 }
							event_target:ftm_marketed_fleet_slot_4_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_4_lot_cost
									value = -1000
								}		
							}
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_4_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_4_lot_cost
										value >= 100
									}
								}
							}
							add_resource = { energy = -100 }
							event_target:ftm_marketed_fleet_slot_4_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_4_lot_cost
									value = -100
								}
							}					
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_4_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_4_lot_cost
										value >= 10
									}
								}
							}
							add_resource = { energy = -10 }
							event_target:ftm_marketed_fleet_slot_4_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_4_lot_cost
									value = -10
								}
							}
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_4_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_4_lot_cost
										value >= 1
									}
								}
							}
							add_resource = { energy = -1 }
							event_target:ftm_marketed_fleet_slot_4_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_4_lot_cost
									value = -1
								}					
							}
						}
						else = {
							#nothing
						}
					}
					
					country_event = { id = ftm_market.415 }
					event_target:ftm_marketed_fleet_slot_4_seller = {
						country_event = { id = ftm_market.416 }
					}
				}
			}
		}
	}
}


################################################################
##### cлот 5

# условие отображения когда лота нет
ftm_market_slot_5_no_info = {
	potential = {
		NOT = {
			has_global_flag = ftm_market_slot_5_selected
		}
	}
	allow = {
		always = yes
	}
	effect = {
		if = {
			limit = {
				NOT = {
					has_global_flag = ftm_market_slot_5_in_progress		
				}			
			}
			hidden_effect = {
				country_event = { id = ftm_market.501 }
				set_global_flag = ftm_market_slot_5_in_progress
			}
		}
		else = {
			custom_tooltip = ftm_market_slot_in_progress_info
		}
	}
}

# условие отображение информации (для покупателей)
ftm_market_slot_5_info = {
	potential = {
		has_global_flag = ftm_market_slot_5_selected
		NOT = {
			is_same_value = event_target:ftm_marketed_fleet_slot_5_seller
		}
		has_communications = event_target:ftm_marketed_fleet_slot_5_seller
	}
	allow = {
		always = yes
	}
	effect = {
		hidden_effect = {
			country_event = { id = ftm_market.510 }
		}
	}
}

# условие отображения информации (для покупателей) если не знаком с продавцом
ftm_market_slot_5_unknown_info = {
	potential = {
		has_global_flag = ftm_market_slot_5_selected
		NOT = {
			is_same_value = event_target:ftm_marketed_fleet_slot_5_seller
		}
		NOT = {
			has_communications = event_target:ftm_marketed_fleet_slot_5_seller
		}
	}
	allow = {
		always = yes
	}
	effect = {
	}
}

# условие отображение информации (для продавца)
ftm_market_slot_5_info_seller = {
	potential = {
		has_global_flag = ftm_market_slot_5_selected
		is_same_value = event_target:ftm_marketed_fleet_slot_5_seller
	}
	allow = {
		always = yes
	}
	effect = {
		hidden_effect = {
			country_event = { id = ftm_market.510 }
		}
	}
}

# условие снятия флота с продажи (для продавца)
ftm_market_slot_5_unsell = {
	potential = {
		has_global_flag = ftm_market_slot_5_selected
		is_same_value = event_target:ftm_marketed_fleet_slot_5_seller
	}
	allow = {
		always = yes
	}
	effect = {
		hidden_effect = {
			country_event = { id = ftm_market.520 }
		}
	}
}

# условие отображения кнопки "купить"
ftm_market_slot_5_buy = {
	potential = {
		has_global_flag = ftm_market_slot_5_selected
		NOT = {
			is_same_value = event_target:ftm_marketed_fleet_slot_5_seller
		}
		has_communications = event_target:ftm_marketed_fleet_slot_5_seller
	}
	allow = {
		always = yes
	}
	effect = {
		custom_tooltip = ftm_market_slot_5_buy_info
		hidden_effect = {
			log = "[Root.GetName] want to buy fleet in slot 5."

		### energy check
			event_target:ftm_marketed_fleet_slot_5_seller = { 
				set_variable = {
					which = ftm_buyer_marketed_fleet_slot_5_energy_current_count
					value = 0
				}
			}
			set_variable = {
				which = ftm_buyer_marketed_fleet_slot_5_check_energy
				value = 0
			}
			save_event_target_as = ftm_buyer_marketed_fleet_slot_5_checker
			export_resource_stockpile_to_variable = { resource = energy variable = ftm_buyer_marketed_fleet_slot_5_check_energy }
			event_target:ftm_marketed_fleet_slot_5_seller = {
				set_variable = {
					which = ftm_buyer_marketed_fleet_slot_5_energy_current_count
					value = event_target:ftm_buyer_marketed_fleet_slot_5_checker.ftm_buyer_marketed_fleet_slot_5_check_energy
				}
			}
			log = "[Root.GetName]: energy_check complete. ENERGY: [event_target:ftm_marketed_fleet_slot_5_seller.ftm_buyer_marketed_fleet_slot_5_energy_current_count]."
			
			
			### 
			
			#4
			if = {
				limit = {
					event_target:ftm_marketed_fleet_slot_5_seller = { 
						check_variable = {
							which = ftm_buyer_marketed_fleet_slot_5_energy_current_count
							value < ftm_marketed_fleet_slot_5_cost
						}
					}
				}
				log = "Check [Root.GetName] energy: need [event_target:ftm_marketed_fleet_slot_5_seller.ftm_marketed_fleet_slot_5_cost]... FAIL. NO ENERGY."
				country_event = { id = ftm_market.505 }
			}
			if = {
				limit = {
					event_target:ftm_marketed_fleet_slot_5_seller = { 
						check_variable = {
							which = ftm_buyer_marketed_fleet_slot_5_energy_current_count
							value >= ftm_marketed_fleet_slot_5_cost
						}
					}
				}
				log = "Check [Root.GetName] energy: need [event_target:ftm_marketed_fleet_slot_5_seller.ftm_marketed_fleet_slot_5_cost]... SUCCESS. ENERGY IN."
				log = "Checking [Root.GetName] and [event_target:ftm_marketed_fleet_slot_5_seller.GetName] opinion..."
				
				# продавец - ai, отношение выше -50
				if = {
					limit = {
						AND = {
							NOT = {
								event_target:ftm_marketed_fleet_slot_5_seller = {
									OR = {
										is_rival = prev
										opinion = {
											who = prev
											value < -50
										}
										their_opinion = {
											who = prev
											value < -50
										}
									}
								}
							}
							event_target:ftm_marketed_fleet_slot_5_seller = {
								is_ai = yes
							}
						}
					}
					log = "[event_target:ftm_marketed_fleet_slot_5_seller.GetName] is AI. Opinion GOOD."
					save_global_event_target_as = ftm_market_slot_5_buyer
					
					# передача флота и денег
					event_target:ftm_marketed_fleet_slot_5 = { 
						set_owner = event_target:ftm_market_slot_5_buyer
						set_event_locked = no
					}
					event_target:ftm_market_slot_5_buyer = { 
						country_event = { id = ftm_market.511 }
					
					
						# снятие ресурсов при покупке			
				
						event_target:ftm_marketed_fleet_slot_5_seller = { 
							set_variable = {
								which = ftm_marketed_fleet_slot_5_lot_cost
								value = ftm_marketed_fleet_slot_5_cost
							}
						}
						log = "[Root.GetName]: [event_target:ftm_marketed_fleet_slot_5_seller.ftm_marketed_fleet_slot_5_lot_cost] energy is SLOT-1 cost"	
						while = {
							count = 99
							if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_5_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_5_lot_cost
											value >= 10000
										}
									}
								}
								add_resource = { energy = -10000 }
								event_target:ftm_marketed_fleet_slot_5_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_5_lot_cost
										value = -10000
									}
								}
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_5_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_5_lot_cost
											value >= 1000
										}
									}
								}
								add_resource = { energy = -1000 }
								event_target:ftm_marketed_fleet_slot_5_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_5_lot_cost
										value = -1000
									}		
								}
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_5_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_5_lot_cost
											value >= 100
										}
									}
								}
								add_resource = { energy = -100 }
								event_target:ftm_marketed_fleet_slot_5_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_5_lot_cost
										value = -100
									}
								}					
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_5_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_5_lot_cost
											value >= 10
										}
									}
								}
								add_resource = { energy = -10 }
								event_target:ftm_marketed_fleet_slot_5_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_5_lot_cost
										value = -10
									}
								}
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_5_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_5_lot_cost
											value >= 1
										}
									}
								}
								add_resource = { energy = -1 }
								event_target:ftm_marketed_fleet_slot_5_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_5_lot_cost
										value = -1
									}					
								}
							}
							else = {
								#nothing
							}
						}	
					}
					event_target:ftm_marketed_fleet_slot_5_seller = { 
						country_event = { id = ftm_market.512 }
					}
					remove_global_flag = ftm_market_slot_5_selected	
				}
				
				# продавец - ai, отношение плохое
				if = {
					limit = {
						AND = {
							event_target:ftm_marketed_fleet_slot_5_seller = {
								OR = {
									is_rival = prev
									opinion = {
										who = prev
										value < -50
									}
									their_opinion = {
										who = prev
										value < -50
									}
								}
							}
							event_target:ftm_marketed_fleet_slot_5_seller = {
								is_ai = yes
							}
						}
					}
					log = "[event_target:ftm_marketed_fleet_slot_5_seller.GetName] is AI. Opinion BAD."
					country_event = { id = ftm_market.514 }
				}
				
				# продавец - игрок
				if = {
					limit = {
						event_target:ftm_marketed_fleet_slot_5_seller = {
							is_ai = no
						}
					}
					log = "[event_target:ftm_marketed_fleet_slot_5_seller.GetName] is PLAYER. Sending request..."
					save_event_target_as = ftm_market_slot_5_requester
					
				
					# снятие ресурсов 	
			
					event_target:ftm_marketed_fleet_slot_5_seller = { 
						set_variable = {
							which = ftm_marketed_fleet_slot_5_lot_cost
							value = ftm_marketed_fleet_slot_5_cost
						}
					}	
					while = {
						count = 99
						if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_5_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_5_lot_cost
										value >= 10000
									}
								}
							}
							add_resource = { energy = -10000 }
							event_target:ftm_marketed_fleet_slot_5_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_5_lot_cost
									value = -10000
								}
							}
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_5_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_5_lot_cost
										value >= 1000
									}
								}
							}
							add_resource = { energy = -1000 }
							event_target:ftm_marketed_fleet_slot_5_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_5_lot_cost
									value = -1000
								}		
							}
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_5_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_5_lot_cost
										value >= 100
									}
								}
							}
							add_resource = { energy = -100 }
							event_target:ftm_marketed_fleet_slot_5_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_5_lot_cost
									value = -100
								}
							}					
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_5_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_5_lot_cost
										value >= 10
									}
								}
							}
							add_resource = { energy = -10 }
							event_target:ftm_marketed_fleet_slot_5_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_5_lot_cost
									value = -10
								}
							}
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_5_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_5_lot_cost
										value >= 1
									}
								}
							}
							add_resource = { energy = -1 }
							event_target:ftm_marketed_fleet_slot_5_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_5_lot_cost
									value = -1
								}					
							}
						}
						else = {
							#nothing
						}
					}
					
					country_event = { id = ftm_market.515 }
					event_target:ftm_marketed_fleet_slot_5_seller = {
						country_event = { id = ftm_market.516 }
					}
				}
			}
		}
	}
}


################################################################
##### cлот 6

# условие отображения когда лота нет
ftm_market_slot_6_no_info = {
	potential = {
		NOT = {
			has_global_flag = ftm_market_slot_6_selected
		}
	}
	allow = {
		always = yes
	}
	effect = {
		if = {
			limit = {
				NOT = {
					has_global_flag = ftm_market_slot_6_in_progress		
				}			
			}
			hidden_effect = {
				country_event = { id = ftm_market.601 }
				set_global_flag = ftm_market_slot_6_in_progress
			}
		}
		else = {
			custom_tooltip = ftm_market_slot_in_progress_info
		}
	}
}

# условие отображение информации (для покупателей)
ftm_market_slot_6_info = {
	potential = {
		has_global_flag = ftm_market_slot_6_selected
		NOT = {
			is_same_value = event_target:ftm_marketed_fleet_slot_6_seller
		}
		has_communications = event_target:ftm_marketed_fleet_slot_6_seller
	}
	allow = {
		always = yes
	}
	effect = {
		hidden_effect = {
			country_event = { id = ftm_market.610 }
		}
	}
}

# условие отображения информации (для покупателей) если не знаком с продавцом
ftm_market_slot_6_unknown_info = {
	potential = {
		has_global_flag = ftm_market_slot_6_selected
		NOT = {
			is_same_value = event_target:ftm_marketed_fleet_slot_6_seller
		}
		NOT = {
			has_communications = event_target:ftm_marketed_fleet_slot_6_seller
		}
	}
	allow = {
		always = yes
	}
	effect = {
	}
}

# условие отображение информации (для продавца)
ftm_market_slot_6_info_seller = {
	potential = {
		has_global_flag = ftm_market_slot_6_selected
		is_same_value = event_target:ftm_marketed_fleet_slot_6_seller
	}
	allow = {
		always = yes
	}
	effect = {
		hidden_effect = {
			country_event = { id = ftm_market.610 }
		}
	}
}

# условие снятия флота с продажи (для продавца)
ftm_market_slot_6_unsell = {
	potential = {
		has_global_flag = ftm_market_slot_6_selected
		is_same_value = event_target:ftm_marketed_fleet_slot_6_seller
	}
	allow = {
		always = yes
	}
	effect = {
		hidden_effect = {
			country_event = { id = ftm_market.620 }
		}
	}
}

# условие отображения кнопки "купить"
ftm_market_slot_6_buy = {
	potential = {
		has_global_flag = ftm_market_slot_6_selected
		NOT = {
			is_same_value = event_target:ftm_marketed_fleet_slot_6_seller
		}
		has_communications = event_target:ftm_marketed_fleet_slot_6_seller
	}
	allow = {
		always = yes
	}
	effect = {
		custom_tooltip = ftm_market_slot_6_buy_info
		hidden_effect = {
			log = "[Root.GetName] want to buy fleet in slot 6."

		### energy check
			event_target:ftm_marketed_fleet_slot_6_seller = { 
				set_variable = {
					which = ftm_buyer_marketed_fleet_slot_6_energy_current_count
					value = 0
				}
			}
			set_variable = {
				which = ftm_buyer_marketed_fleet_slot_6_check_energy
				value = 0
			}
			save_event_target_as = ftm_buyer_marketed_fleet_slot_6_checker
			export_resource_stockpile_to_variable = { resource = energy variable = ftm_buyer_marketed_fleet_slot_6_check_energy }
			event_target:ftm_marketed_fleet_slot_6_seller = {
				set_variable = {
					which = ftm_buyer_marketed_fleet_slot_6_energy_current_count
					value = event_target:ftm_buyer_marketed_fleet_slot_6_checker.ftm_buyer_marketed_fleet_slot_6_check_energy
				}
			}
			log = "[Root.GetName]: energy_check complete. ENERGY: [event_target:ftm_marketed_fleet_slot_6_seller.ftm_buyer_marketed_fleet_slot_6_energy_current_count]."
			
			
			### 
			
			#4
			if = {
				limit = {
					event_target:ftm_marketed_fleet_slot_6_seller = { 
						check_variable = {
							which = ftm_buyer_marketed_fleet_slot_6_energy_current_count
							value < ftm_marketed_fleet_slot_6_cost
						}
					}
				}
				log = "Check [Root.GetName] energy: need [event_target:ftm_marketed_fleet_slot_6_seller.ftm_marketed_fleet_slot_6_cost]... FAIL. NO ENERGY."
				country_event = { id = ftm_market.605 }
			}
			if = {
				limit = {
					event_target:ftm_marketed_fleet_slot_6_seller = { 
						check_variable = {
							which = ftm_buyer_marketed_fleet_slot_6_energy_current_count
							value >= ftm_marketed_fleet_slot_6_cost
						}
					}
				}
				log = "Check [Root.GetName] energy: need [event_target:ftm_marketed_fleet_slot_6_seller.ftm_marketed_fleet_slot_6_cost]... SUCCESS. ENERGY IN."
				log = "Checking [Root.GetName] and [event_target:ftm_marketed_fleet_slot_6_seller.GetName] opinion..."
				
				# продавец - ai, отношение выше -50
				if = {
					limit = {
						AND = {
							NOT = {
								event_target:ftm_marketed_fleet_slot_6_seller = {
									OR = {
										is_rival = prev
										opinion = {
											who = prev
											value < -50
										}
										their_opinion = {
											who = prev
											value < -50
										}
									}
								}
							}
							event_target:ftm_marketed_fleet_slot_6_seller = {
								is_ai = yes
							}
						}
					}
					log = "[event_target:ftm_marketed_fleet_slot_6_seller.GetName] is AI. Opinion GOOD."
					save_global_event_target_as = ftm_market_slot_6_buyer
					
					# передача флота и денег
					event_target:ftm_marketed_fleet_slot_6 = { 
						set_owner = event_target:ftm_market_slot_6_buyer
						set_event_locked = no
					}
					event_target:ftm_market_slot_6_buyer = { 
						country_event = { id = ftm_market.611 }
					
					
						# снятие ресурсов при покупке			
				
						event_target:ftm_marketed_fleet_slot_6_seller = { 
							set_variable = {
								which = ftm_marketed_fleet_slot_6_lot_cost
								value = ftm_marketed_fleet_slot_6_cost
							}
						}
						log = "[Root.GetName]: [event_target:ftm_marketed_fleet_slot_6_seller.ftm_marketed_fleet_slot_6_lot_cost] energy is SLOT-1 cost"	
						while = {
							count = 99
							if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_6_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_6_lot_cost
											value >= 10000
										}
									}
								}
								add_resource = { energy = -10000 }
								event_target:ftm_marketed_fleet_slot_6_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_6_lot_cost
										value = -10000
									}
								}
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_6_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_6_lot_cost
											value >= 1000
										}
									}
								}
								add_resource = { energy = -1000 }
								event_target:ftm_marketed_fleet_slot_6_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_6_lot_cost
										value = -1000
									}		
								}
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_6_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_6_lot_cost
											value >= 100
										}
									}
								}
								add_resource = { energy = -100 }
								event_target:ftm_marketed_fleet_slot_6_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_6_lot_cost
										value = -100
									}
								}					
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_6_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_6_lot_cost
											value >= 10
										}
									}
								}
								add_resource = { energy = -10 }
								event_target:ftm_marketed_fleet_slot_6_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_6_lot_cost
										value = -10
									}
								}
							}
							else_if = {
								limit = {
									event_target:ftm_marketed_fleet_slot_6_seller = { 
										check_variable = {
											which = ftm_marketed_fleet_slot_6_lot_cost
											value >= 1
										}
									}
								}
								add_resource = { energy = -1 }
								event_target:ftm_marketed_fleet_slot_6_seller = { 
									change_variable = {
										which = ftm_marketed_fleet_slot_6_lot_cost
										value = -1
									}					
								}
							}
							else = {
								#nothing
							}
						}	
					}
					event_target:ftm_marketed_fleet_slot_6_seller = { 
						country_event = { id = ftm_market.612 }
					}
					remove_global_flag = ftm_market_slot_6_selected	
				}
				
				# продавец - ai, отношение плохое
				if = {
					limit = {
						AND = {
							event_target:ftm_marketed_fleet_slot_6_seller = {
								OR = {
									is_rival = prev
									opinion = {
										who = prev
										value < -50
									}
									their_opinion = {
										who = prev
										value < -50
									}
								}
							}
							event_target:ftm_marketed_fleet_slot_6_seller = {
								is_ai = yes
							}
						}
					}
					log = "[event_target:ftm_marketed_fleet_slot_6_seller.GetName] is AI. Opinion BAD."
					country_event = { id = ftm_market.614 }
				}
				
				# продавец - игрок
				if = {
					limit = {
						event_target:ftm_marketed_fleet_slot_6_seller = {
							is_ai = no
						}
					}
					log = "[event_target:ftm_marketed_fleet_slot_6_seller.GetName] is PLAYER. Sending request..."
					save_event_target_as = ftm_market_slot_6_requester
					
				
					# снятие ресурсов 	
			
					event_target:ftm_marketed_fleet_slot_6_seller = { 
						set_variable = {
							which = ftm_marketed_fleet_slot_6_lot_cost
							value = ftm_marketed_fleet_slot_6_cost
						}
					}	
					while = {
						count = 99
						if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_6_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_6_lot_cost
										value >= 10000
									}
								}
							}
							add_resource = { energy = -10000 }
							event_target:ftm_marketed_fleet_slot_6_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_6_lot_cost
									value = -10000
								}
							}
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_6_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_6_lot_cost
										value >= 1000
									}
								}
							}
							add_resource = { energy = -1000 }
							event_target:ftm_marketed_fleet_slot_6_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_6_lot_cost
									value = -1000
								}		
							}
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_6_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_6_lot_cost
										value >= 100
									}
								}
							}
							add_resource = { energy = -100 }
							event_target:ftm_marketed_fleet_slot_6_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_6_lot_cost
									value = -100
								}
							}					
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_6_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_6_lot_cost
										value >= 10
									}
								}
							}
							add_resource = { energy = -10 }
							event_target:ftm_marketed_fleet_slot_6_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_6_lot_cost
									value = -10
								}
							}
						}
						else_if = {
							limit = {
								event_target:ftm_marketed_fleet_slot_6_seller = { 
									check_variable = {
										which = ftm_marketed_fleet_slot_6_lot_cost
										value >= 1
									}
								}
							}
							add_resource = { energy = -1 }
							event_target:ftm_marketed_fleet_slot_6_seller = { 
								change_variable = {
									which = ftm_marketed_fleet_slot_6_lot_cost
									value = -1
								}					
							}
						}
						else = {
							#nothing
						}
					}
					
					country_event = { id = ftm_market.615 }
					event_target:ftm_marketed_fleet_slot_6_seller = {
						country_event = { id = ftm_market.616 }
					}
				}
			}
		}
	}
}